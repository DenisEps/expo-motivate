{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/d_kuprin/expo-motivate/client/src/components/Auth/RegistrationForm/index.js\";\nimport React from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Layout, Button, Input, Submit, Text } from \"@ui-kitten/components\";\nimport { firebase } from \"../../../../firebase\";\nimport AsyncStorage from \"@react-native-community/async-storage\";\nimport { userAuth } from \"../../../redux/actions\";\nimport { useDispatch } from \"react-redux\";\n\nvar RegistrationForm = function RegistrationForm() {\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      error = _React$useState2[0],\n      setError = _React$useState2[1];\n\n  var _React$useState3 = React.useState(\"\"),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      email = _React$useState4[0],\n      setEmail = _React$useState4[1];\n\n  var _React$useState5 = React.useState(\"\"),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      pass = _React$useState6[0],\n      setPass = _React$useState6[1];\n\n  var _React$useState7 = React.useState(null),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      authUser = _React$useState8[0],\n      setAuthUser = _React$useState8[1];\n\n  var _React$useState9 = React.useState(null),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      emailMessage = _React$useState10[0],\n      setEmailMessage = _React$useState10[1];\n\n  var dispatch = useDispatch();\n\n  var save = function save(user) {\n    var objectValue, err;\n    return _regeneratorRuntime.async(function save$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            objectValue = JSON.stringify(user);\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"user\", objectValue));\n\n          case 4:\n            _context.next = 10;\n            break;\n\n          case 6:\n            _context.prev = 6;\n            _context.t0 = _context[\"catch\"](0);\n            err = new Error(_context.t0);\n            setError(err.message);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 6]], Promise);\n  };\n\n  var CreateUser = function CreateUser(email, pass) {\n    var user, currentUser, uid, _error;\n\n    return _regeneratorRuntime.async(function CreateUser$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(firebase.auth().createUserWithEmailAndPassword(email, pass).then(function (info) {\n              return firebase.firestore().collection(\"users\").doc(info.user.uid).set({\n                email: info.user.email == null ? '' : info.user.email,\n                displayName: info.user.displayName == null ? '' : info.user.displayName,\n                photoURL: info.user.photoURL == null ? '' : info.user.photoURL,\n                phoneNumber: info.user.phoneNumber == null ? '' : info.user.phoneNumber,\n                emailVerified: info.user.emailVerified == null ? '' : info.user.emailVerified,\n                habits: [],\n                level: 1\n              });\n            }));\n\n          case 3:\n            user = _context2.sent;\n            currentUser = firebase.auth().currentUser;\n            uid = firebase.auth().currentUser.uid;\n            _context2.next = 8;\n            return _regeneratorRuntime.awrap(firebase.firestore().collection(\"users\").doc(uid).get().then(function (info) {\n              return save(info.data());\n            }));\n\n          case 8:\n            console.log(uid);\n            dispatch(userAuth(true));\n            currentUser.sendEmailVerification().then(function () {\n              setEmailMessage(\"Подтвердите Ваш email на почте\");\n            }).catch(function (err) {\n              var error = new Error(err);\n              setError(error.message);\n            });\n            console.log('>>>>>>>>>>>>>>>>>>>>>>>>>>>>> test');\n            setAuthUser(user);\n            setError(null);\n            setEmail(\"\");\n            setPass(\"\");\n            setEmailMessage(\"\");\n            _context2.next = 24;\n            break;\n\n          case 19:\n            _context2.prev = 19;\n            _context2.t0 = _context2[\"catch\"](0);\n            _error = new Error(_context2.t0);\n            setError(_error.message);\n            console.log(_error);\n\n          case 24:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 19]], Promise);\n  };\n\n  return React.createElement(Layout, {\n    style: {\n      alignItems: \"center\",\n      top: 250,\n      minWidth: 200\n    },\n    level: \"1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }, React.createElement(Input, {\n    style: {\n      width: \"75%\"\n    },\n    placeholder: \"Email\",\n    value: email,\n    onChangeText: function onChangeText(nextValue) {\n      return setEmail(nextValue);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }), React.createElement(Input, {\n    style: {\n      width: \"75%\"\n    },\n    secureTextEntry: true,\n    placeholder: \"Password\",\n    value: pass,\n    onChangeText: function onChangeText(nextValue) {\n      return setPass(nextValue);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }), React.createElement(Button, {\n    style: {\n      width: \"75%\"\n    },\n    onPress: function onPress() {\n      return CreateUser(email, pass);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }, \"Register\"));\n};\n\nvar styles = StyleSheet.create({\n  error: {\n    marginTop: 16,\n    paddingVertical: 8,\n    borderWidth: 2,\n    borderColor: \"red\",\n    borderRadius: 6,\n    color: \"red\",\n    textAlign: \"center\",\n    fontSize: 25,\n    fontWeight: \"bold\"\n  },\n  message: {\n    marginTop: 16,\n    paddingVertical: 8,\n    borderWidth: 2,\n    borderColor: \"green\",\n    borderRadius: 6,\n    color: \"green\",\n    textAlign: \"center\",\n    fontSize: 25,\n    fontWeight: \"bold\"\n  },\n  container: {\n    flex: 1\n  }\n});\nexport default RegistrationForm;","map":{"version":3,"sources":["/Users/d_kuprin/expo-motivate/client/src/components/Auth/RegistrationForm/index.js"],"names":["React","Layout","Button","Input","Submit","Text","firebase","AsyncStorage","userAuth","useDispatch","RegistrationForm","useState","error","setError","email","setEmail","pass","setPass","authUser","setAuthUser","emailMessage","setEmailMessage","dispatch","save","user","objectValue","JSON","stringify","setItem","err","Error","message","CreateUser","auth","createUserWithEmailAndPassword","then","info","firestore","collection","doc","uid","set","displayName","photoURL","phoneNumber","emailVerified","habits","level","currentUser","get","data","console","log","sendEmailVerification","catch","alignItems","top","minWidth","width","nextValue","styles","StyleSheet","create","marginTop","paddingVertical","borderWidth","borderColor","borderRadius","color","textAlign","fontSize","fontWeight","container","flex"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport { Layout, Button, Input, Submit, Text } from \"@ui-kitten/components\";\nimport { firebase } from \"../../../../firebase\";\nimport AsyncStorage from \"@react-native-community/async-storage\";\nimport { userAuth } from \"../../../redux/actions\";\nimport { useDispatch } from \"react-redux\";\n\nconst RegistrationForm = () => {\n  const [error, setError] = React.useState(null);\n  const [email, setEmail] = React.useState(\"\");\n  const [pass, setPass] = React.useState(\"\");\n  const [authUser, setAuthUser] = React.useState(null);\n  const [emailMessage, setEmailMessage] = React.useState(null);\n  const dispatch = useDispatch();\n\n  // const provider = new firebase.auth.GoogleAuthProvider()\n\n  const save = async (user) => {\n    try {\n      const objectValue = JSON.stringify(user);\n      await AsyncStorage.setItem(\"user\", objectValue);\n    } catch (e) {\n      const err = new Error(e);\n      setError(err.message);\n    }\n  };\n\n  const CreateUser = async (email, pass) => {\n    try {\n      const user = await firebase\n        .auth()\n        .createUserWithEmailAndPassword(email, pass)\n        .then((info) => {\n          return firebase\n            .firestore()\n            .collection(\"users\")\n            .doc(info.user.uid)\n            .set({\n              email: info.user.email == null ? '' : info.user.email,\n              displayName: info.user.displayName == null ? '' : info.user.displayName,\n              photoURL: info.user.photoURL == null ? '' : info.user.photoURL,\n              phoneNumber: info.user.phoneNumber == null ? '' : info.user.phoneNumber,\n              emailVerified: info.user.emailVerified == null ? '' : info.user.emailVerified,\n              habits: [],\n              level: 1,\n            });\n        });\n      const currentUser = firebase.auth().currentUser;\n      const uid = firebase.auth().currentUser.uid;\n      await firebase\n        .firestore()\n        .collection(\"users\")\n        .doc(uid)\n        .get()\n        .then((info) => save(info.data()));\n      console.log(uid);\n      dispatch(userAuth(true));\n      currentUser\n        .sendEmailVerification()\n        .then(() => {\n          setEmailMessage(\"Подтвердите Ваш email на почте\");\n        })\n        .catch((err) => {\n          const error = new Error(err);\n          setError(error.message);\n        });\n      console.log('>>>>>>>>>>>>>>>>>>>>>>>>>>>>> test');\n      setAuthUser(user);\n      setError(null);\n      setEmail(\"\");\n      setPass(\"\");\n      setEmailMessage(\"\");\n    } catch (err) {\n      const error = new Error(err);\n      setError(error.message);\n      console.log(error);\n\n    }\n  };\n\n  return (\n    <Layout\n      style={{\n        alignItems: \"center\",\n        top: 250,\n        minWidth: 200,\n      }}\n      level=\"1\"\n    >\n      <Input\n        style={{ width: \"75%\" }}\n        placeholder=\"Email\"\n        value={email}\n        onChangeText={(nextValue) => setEmail(nextValue)}\n      />\n      <Input\n        style={{ width: \"75%\" }}\n        secureTextEntry={true}\n        placeholder=\"Password\"\n        value={pass}\n        onChangeText={(nextValue) => setPass(nextValue)}\n      />\n      <Button style={{ width: \"75%\" }} onPress={() => CreateUser(email, pass)}>\n        Register\n      </Button>\n      {/* {error && <Text style={styles.error}>{error}</Text>}\n      {emailMessage && <Text style={styles.message}>{emailMessage}</Text>} */}\n    </Layout>\n  );\n};\n\nconst styles = StyleSheet.create({\n  error: {\n    marginTop: 16,\n    paddingVertical: 8,\n    borderWidth: 2,\n    borderColor: \"red\",\n    borderRadius: 6,\n    color: \"red\",\n    textAlign: \"center\",\n    fontSize: 25,\n    fontWeight: \"bold\",\n  },\n  message: {\n    marginTop: 16,\n    paddingVertical: 8,\n    borderWidth: 2,\n    borderColor: \"green\",\n    borderRadius: 6,\n    color: \"green\",\n    textAlign: \"center\",\n    fontSize: 25,\n    fontWeight: \"bold\",\n  },\n  container: {\n    flex: 1,\n  },\n});\n\nexport default RegistrationForm;\n"]},"metadata":{},"sourceType":"module"}